<?php

namespace BradieTilley\Zodiac;

use BradieTilley\Zodiac\Exception\UnsupportedZodiacDateException;
use Carbon\Carbon;

class NewYears
{
    /**
     * Date of Chinese New Year(s)
     */
    public const THRESHOLDS = [
        /**
         * This source provides data from 1645-onwards, but has been capped
         * until 1901 when HKO started reporting lunar cycles.
         *
         * @link https://pinyin.info/chinese_new_year/cny1645-1899.html
         */
        1645 => '1645-01-28',
        1646 => '1646-02-16',
        1647 => '1647-02-05',
        1648 => '1648-01-25',
        1649 => '1649-02-11',
        1650 => '1650-02-01',
        1651 => '1651-01-21',
        1652 => '1652-02-09',
        1653 => '1653-01-29',
        1654 => '1654-02-17',
        1655 => '1655-02-06',
        1656 => '1656-01-26',
        1657 => '1657-02-13',
        1658 => '1658-02-02',
        1659 => '1659-01-23',
        1660 => '1660-02-11',
        1661 => '1661-01-30',
        1662 => '1662-02-18',
        1663 => '1663-02-08',
        1664 => '1664-01-28',
        1665 => '1665-02-15',
        1666 => '1666-02-04',
        1667 => '1667-01-24',
        1668 => '1668-02-12',
        1669 => '1669-02-01',
        1670 => '1670-01-21',
        1671 => '1671-02-09',
        1672 => '1672-01-30',
        1673 => '1673-02-17',
        1674 => '1674-02-06',
        1675 => '1675-01-26',
        1676 => '1676-02-14',
        1677 => '1677-02-02',
        1678 => '1678-01-23',
        1679 => '1679-02-11',
        1680 => '1680-01-31',
        1681 => '1681-02-18',
        1682 => '1682-02-07',
        1683 => '1683-01-27',
        1684 => '1684-02-15',
        1685 => '1685-02-03',
        1686 => '1686-01-24',
        1687 => '1687-02-12',
        1688 => '1688-02-02',
        1689 => '1689-01-21',
        1690 => '1690-02-09',
        1691 => '1691-01-29',
        1692 => '1692-02-17',
        1693 => '1693-02-05',
        1694 => '1694-01-25',
        1695 => '1695-02-13',
        1696 => '1696-02-03',
        1697 => '1697-01-23',
        1698 => '1698-02-11',
        1699 => '1699-01-31',
        1700 => '1700-02-19',
        1701 => '1701-02-08',
        1702 => '1702-01-28',
        1703 => '1703-02-16',
        1704 => '1704-02-05',
        1705 => '1705-01-25',
        1706 => '1706-02-13',
        1707 => '1707-02-03',
        1708 => '1708-01-23',
        1709 => '1709-02-10',
        1710 => '1710-01-30',
        1711 => '1711-02-17',
        1712 => '1712-02-07',
        1713 => '1713-01-26',
        1714 => '1714-02-14',
        1715 => '1715-02-04',
        1716 => '1716-01-24',
        1717 => '1717-02-11',
        1718 => '1718-01-31',
        1719 => '1719-02-19',
        1720 => '1720-02-08',
        1721 => '1721-01-28',
        1722 => '1722-02-16',
        1723 => '1723-02-05',
        1724 => '1724-01-26',
        1725 => '1725-02-13',
        1726 => '1726-02-02',
        1727 => '1727-01-22',
        1728 => '1728-02-10',
        1729 => '1729-01-29',
        1730 => '1730-02-17',
        1731 => '1731-02-07',
        1732 => '1732-01-27',
        1733 => '1733-02-14',
        1734 => '1734-02-04',
        1735 => '1735-01-24',
        1736 => '1736-02-12',
        1737 => '1737-01-31',
        1738 => '1738-02-19',
        1739 => '1739-02-08',
        1740 => '1740-01-29',
        1741 => '1741-02-16',
        1742 => '1742-02-05',
        1743 => '1743-01-26',
        1744 => '1744-02-13',
        1745 => '1745-02-01',
        1746 => '1746-01-22',
        1747 => '1747-02-09',
        1748 => '1748-01-30',
        1749 => '1749-02-17',
        1750 => '1750-02-07',
        1751 => '1751-01-27',
        1752 => '1752-02-15',
        1753 => '1753-02-03',
        1754 => '1754-01-23',
        1755 => '1755-02-11',
        1756 => '1756-01-31',
        1757 => '1757-02-18',
        1758 => '1758-02-08',
        1759 => '1759-01-29',
        1760 => '1760-02-17',
        1761 => '1761-02-05',
        1762 => '1762-01-25',
        1763 => '1763-02-13',
        1764 => '1764-02-02',
        1765 => '1765-01-21',
        1766 => '1766-02-09',
        1767 => '1767-01-30',
        1768 => '1768-02-18',
        1769 => '1769-02-07',
        1770 => '1770-01-27',
        1771 => '1771-02-15',
        1772 => '1772-02-04',
        1773 => '1773-01-23',
        1774 => '1774-02-11',
        1775 => '1775-01-31',
        1776 => '1776-02-19',
        1777 => '1777-02-08',
        1778 => '1778-01-28',
        1779 => '1779-02-16',
        1780 => '1780-02-05',
        1781 => '1781-01-24',
        1782 => '1782-02-12',
        1783 => '1783-02-02',
        1784 => '1784-01-22',
        1785 => '1785-02-09',
        1786 => '1786-01-30',
        1787 => '1787-02-18',
        1788 => '1788-02-07',
        1789 => '1789-01-26',
        1790 => '1790-02-14',
        1791 => '1791-02-03',
        1792 => '1792-01-24',
        1793 => '1793-02-11',
        1794 => '1794-01-31',
        1795 => '1795-01-21',
        1796 => '1796-02-09',
        1797 => '1797-01-28',
        1798 => '1798-02-16',
        1799 => '1799-02-05',
        1800 => '1800-01-25',
        1801 => '1801-02-13',
        1802 => '1802-02-03',
        1803 => '1803-01-23',
        1804 => '1804-02-11',
        1805 => '1805-01-31',
        1806 => '1806-02-18',
        1807 => '1807-02-07',
        1808 => '1808-01-28',
        1809 => '1809-02-14',
        1810 => '1810-02-04',
        1811 => '1811-01-25',
        1812 => '1812-02-13',
        1813 => '1813-02-01',
        1814 => '1814-01-21',
        1815 => '1815-02-09',
        1816 => '1816-01-29',
        1817 => '1817-02-16',
        1818 => '1818-02-05',
        1819 => '1819-01-26',
        1820 => '1820-02-14',
        1821 => '1821-02-03',
        1822 => '1822-01-23',
        1823 => '1823-02-11',
        1824 => '1824-01-31',
        1825 => '1825-02-18',
        1826 => '1826-02-07',
        1827 => '1827-01-27',
        1828 => '1828-02-15',
        1829 => '1829-02-04',
        1830 => '1830-01-25',
        1831 => '1831-02-13',
        1832 => '1832-02-02',
        1833 => '1833-02-20',
        1834 => '1834-02-09',
        1835 => '1835-01-29',
        1836 => '1836-02-17',
        1837 => '1837-02-05',
        1838 => '1838-01-26',
        1839 => '1839-02-14',
        1840 => '1840-02-03',
        1841 => '1841-01-23',
        1842 => '1842-02-10',
        1843 => '1843-01-30',
        1844 => '1844-02-18',
        1845 => '1845-02-07',
        1846 => '1846-01-27',
        1847 => '1847-02-15',
        1848 => '1848-02-05',
        1849 => '1849-01-24',
        1850 => '1850-02-12',
        1851 => '1851-02-01',
        1852 => '1852-02-20',
        1853 => '1853-02-08',
        1854 => '1854-01-29',
        1855 => '1855-02-17',
        1856 => '1856-02-06',
        1857 => '1857-01-26',
        1858 => '1858-02-14',
        1859 => '1859-02-03',
        1860 => '1860-01-23',
        1861 => '1861-02-10',
        1862 => '1862-01-30',
        1863 => '1863-02-18',
        1864 => '1864-02-08',
        1865 => '1865-01-27',
        1866 => '1866-02-15',
        1867 => '1867-02-05',
        1868 => '1868-01-25',
        1869 => '1869-02-11',
        1870 => '1870-01-31',
        1871 => '1871-02-19',
        1872 => '1872-02-09',
        1873 => '1873-01-29',
        1874 => '1874-02-17',
        1875 => '1875-02-06',
        1876 => '1876-01-26',
        1877 => '1877-02-13',
        1878 => '1878-02-02',
        1879 => '1879-01-22',
        1880 => '1880-02-10',
        1881 => '1881-01-30',
        1882 => '1882-02-18',
        1883 => '1883-02-08',
        1884 => '1884-01-28',
        1885 => '1885-02-15',
        1886 => '1886-02-04',
        1887 => '1887-01-24',
        1888 => '1888-02-12',
        1889 => '1889-01-31',
        1890 => '1890-01-21',
        1891 => '1891-02-09',
        1892 => '1892-01-30',
        1893 => '1893-02-17',
        1894 => '1894-02-06',
        1895 => '1895-01-26',
        1896 => '1896-02-13',
        1897 => '1897-02-02',
        1898 => '1898-01-22',
        1899 => '1899-02-10',

        /**
         * Same source as above, but different URL
         *
         * @link https://pinyin.info/chinese_new_year/cny1900-1999.html
         */
        1900 => '1900-01-31',

        /**
         * This source provides year-by-year breakdown for 1901
         * to
         *
         * @link https://www.hko.gov.hk/en/gts/time/calendar/pdf/files/1901e.pdf
         * @link https://www.hko.gov.hk/en/gts/time/calendar/pdf/files/{YEAR}e.pdf
         */
        1901 => '1901-02-19',
        1902 => '1902-02-08',
        1903 => '1903-01-29',
        1904 => '1904-02-16',
        1905 => '1905-02-04',
        1906 => '1906-01-25',
        1907 => '1907-02-13',
        1908 => '1908-02-02',
        1909 => '1909-01-22',
        1910 => '1910-02-10',
        1911 => '1911-01-30',
        1912 => '1912-02-18',
        1913 => '1913-02-06',
        1914 => '1914-01-26',
        1915 => '1915-02-14',
        1916 => '1916-02-03',
        1917 => '1917-01-23',
        1918 => '1918-02-11',
        1919 => '1919-02-01',
        1920 => '1920-02-20',
        1921 => '1921-02-08',
        1922 => '1922-01-28',
        1923 => '1923-02-16',
        1924 => '1924-02-05',
        1925 => '1925-01-24',
        1926 => '1926-02-13',
        1927 => '1927-02-02',
        1928 => '1928-01-23',
        1929 => '1929-02-10',
        1930 => '1930-01-30',
        1931 => '1931-02-17',
        1932 => '1932-02-06',
        1933 => '1933-01-26',
        1934 => '1934-02-14',
        1935 => '1935-02-04',
        1936 => '1936-01-24',
        1937 => '1937-02-11',
        1938 => '1938-01-31',
        1939 => '1939-02-19',
        1940 => '1940-02-08',
        1941 => '1941-01-27',
        1942 => '1942-02-15',
        1943 => '1943-02-05',
        1944 => '1944-01-25',
        1945 => '1945-02-13',
        1946 => '1946-02-02',
        1947 => '1947-01-22',
        1948 => '1948-02-10',
        1949 => '1949-01-29',
        1950 => '1950-02-17',
        1951 => '1951-02-06',
        1952 => '1952-01-27',
        1953 => '1953-02-14',
        1954 => '1954-02-03',
        1955 => '1955-01-24',
        1956 => '1956-02-12',
        1957 => '1957-01-31',
        1958 => '1958-02-18',
        1959 => '1959-02-08',
        1960 => '1960-01-28',
        1961 => '1961-02-15',
        1962 => '1962-02-05',
        1963 => '1963-01-25',
        1964 => '1964-02-13',
        1965 => '1965-02-02',
        1966 => '1966-01-21',
        1967 => '1967-02-09',
        1968 => '1968-01-30',
        1969 => '1969-02-17',
        1970 => '1970-02-06',
        1971 => '1971-01-27',
        1972 => '1972-02-15',
        1973 => '1973-02-03',
        1974 => '1974-01-23',
        1975 => '1975-02-11',
        1976 => '1976-01-31',
        1977 => '1977-02-18',
        1978 => '1978-02-07',
        1979 => '1979-01-28',
        1980 => '1980-02-16',
        1981 => '1981-02-05',
        1982 => '1982-01-25',
        1983 => '1983-02-13',
        1984 => '1984-02-02',
        1985 => '1985-02-20',
        1986 => '1986-02-09',
        1987 => '1987-01-29',
        1988 => '1988-02-17',
        1989 => '1989-02-06',
        1990 => '1990-01-27',
        1991 => '1991-02-15',
        1992 => '1992-02-04',
        1993 => '1993-01-23',
        1994 => '1994-02-10',
        1995 => '1995-01-31',
        1996 => '1996-02-19',
        1997 => '1997-02-07',
        1998 => '1998-01-28',
        1999 => '1999-02-16',
        2000 => '2000-02-05',
        2001 => '2001-01-24',
        2002 => '2002-02-12',
        2003 => '2003-02-01',
        2004 => '2004-01-22',
        2005 => '2005-02-09',
        2006 => '2006-01-29',
        2007 => '2007-02-18',
        2008 => '2008-02-07',
        2009 => '2009-01-26',
        2010 => '2010-02-14',
        2011 => '2011-02-03',
        2012 => '2012-01-23',
        2013 => '2013-02-10',
        2014 => '2014-01-31',
        2015 => '2015-02-19',
        2016 => '2016-02-08',
        2017 => '2017-01-28',
        2018 => '2018-02-16',
        2019 => '2019-02-05',
        2020 => '2020-01-25',
        2021 => '2021-02-12',
        2022 => '2022-02-01',
        2023 => '2023-01-22',
        2024 => '2024-02-10',
        2025 => '2025-01-29',
        2026 => '2026-02-17',
        2027 => '2027-02-06',
        2028 => '2028-01-26',
        2029 => '2029-02-13',
        2030 => '2030-02-03',
        2031 => '2031-01-23',
        2032 => '2032-02-11',
        2033 => '2033-01-31',
    ];

    public const MIN = 1648;

    public const MAX = 2033;

    /**
     * Validate that we have the answers for this given date
     *
     * @throws UnsupportedZodiacDateException if the date is out of range
     */
    public static function validate(Carbon|int $date): void
    {
        $date = $date instanceof Carbon ? $date->year : $date;

        if ($date < self::MIN) {
            throw UnsupportedZodiacDateException::exceedsMinimum($date);
        }

        if ($date > self::MAX) {
            throw UnsupportedZodiacDateException::exceedsMaximum($date);
        }
    }
}
